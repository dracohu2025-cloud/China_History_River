# 🔧 Bug修复: 播放按钮与年份重叠

**问题**: 播放按钮和年份叠到了一起

**原因**: `transform`的`y`轴偏移计算错误，导致播放按钮向上偏移与年份重叠

**修复时间**: 2025-11-28 22:55  
**修复版本**: v1.0.0-release+patch

---

## 🔴 Bug现象

播放按钮▶和年份数字重叠显示在一起，视觉上混乱

```
❌ 错误显示:
┌──────────┐
│ 《失去... │
│          │
│ ▶1516    │  ← 重叠了！
└──────────┘
```

## 🔍 根本原因

**错误代码**:
```typescript
<g transform={`translate(${CARD_WIDTH/2 - 4}, ${20})`}>
  <text x={0} y={3} textAnchor="end">{pin.year}</text>
  
  {/* 错误: y轴偏移-3导致向上移动重叠 */}
  <g transform={`translate(-12, -3)`}>  {/* ❌ y:-3 错误 */}
    <circle r={5} fill="#d97706" />
  </g>
</g>
```

**问题分析**:
- 年份在 `y=3` 的位置
- 播放按钮使用了 `translate(-12, -3)`，y轴向上偏移3px
- 导致播放按钮实际位置是 `y=0` (3 - 3 = 0)
- 视觉上与年份重叠

---

## 💊 修复方案

**修复代码**:
```typescript
<g transform={`translate(${CARD_WIDTH/2 - 4}, ${20})`}>
  <text x={0} y={3} textAnchor="end">{pin.year}</text>
  
  {/* 修复: 移除y轴偏移，仅保留水平偏移 */}
  <g transform={`translate(-9, 0)`}>  {/* ✅ 仅x:-9，不移除y轴 */}
    <circle r={5} fill="#d97706" />
  </g>
</g>
```

**修复说明**:
- 播放按钮位置: 年份x坐标 - 9px
- y轴: 保持与年份相同的y坐标（通过`translate(-9, 0)`，y轴为0）
- 结果: 播放按钮在年份左侧9px，同一水平线，不会重叠

---

## ✅ 修复后效果

```
✅ 正确显示:
┌──────────┐
│ 《失去... │
│          │
│ ▶  1516  │  ← 不重叠！
└──────────┘
```

**布局坐标**:
- 年份: `x=CARD_WIDTH/2 - 4`, `y=20`
- 播放按钮: `x=CARD_WIDTH/2 - 4 - 9`, `y=20` (x:-9, y:0)
- 间距: 9px (5px按钮半径 + 4px间距)

---

## 🧪 验证

访问 https://history.aigc24.com/:

1. **拖拽到1516年**（《失去的三百年》）
2. **观察底部播客轨道**
3. ✅ 播放按钮和年份应该**不重叠**
4. ✅ 播放按钮在年份左侧
5. ✅ 点击播放按钮可以正常播放播客

---

## 📊 修复总结

| 项目 | 修改前 | 修改后 |
|------|--------|--------|
| y轴偏移 | -3 | **0** ✅ |
| x轴偏移 | -12 | **-9** ✅ |
| 是否重叠 | 是 ❌ | 否 ✅ |
| 间距 | 0px | 9px ✅ |

---

**编译**: ✅ `npm run build` 成功  
**服务**: ✅ PM2前端已重启 (PID 86387)  
**状态**: 🟢 **生产就绪**
